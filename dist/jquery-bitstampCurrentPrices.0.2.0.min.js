/*!
 * Display the latest Bitstamp Bitcoin prices with jquery-bitstampCurrentPrices - v0.2.0 - 2014-06-25
 * https://github.com/bit-2-bit/bitstamp-current-prices
 * Copyright (c) 2014 Dave Sag; Licensed MIT
 */

(function(){if("function"!=typeof jQuery)throw"Expected jQuery to have been loaded before this script."}).call(this),function(){!function(a){var b,c;return b=["bid","ask","last","high","low","vwap","volume","timestamp"],c=function(){function b(){}var c,d;return d=null,c=function(){function b(){this.url="https://www.bitstamp.net/api/ticker/",this.prices={btc:{}},this.lastLoadTime=null,this.delay=6e4,this.loading=!1}return b.prototype.loadPrices=function(){var b,c,d,e,f;c=function(b){return function(c){var d;d=a.parseJSON(c.query.results.body.p),d?(b.prices.btc=d,b.lastLoadTime=new Date,a(document).trigger("price-change",[b.prices])):console.error("server returned",c.query.results.body.p)}}(this),d=function(a){console.error(a)},b=function(a){return function(){a.loading=!1,setTimeout(function(){return a.loadPrices()},a.delay)}}(this),!this.loading&&(null===this.lastLoadTime||this.lastLoadTime-1+this.delay<=new Date)&&(this.loading=!0,e=encodeURI("select * from html where url="),f="http://query.yahooapis.com/v1/public/yql?q="+e+'"'+this.url+'"&format=json&callback=?',a.getJSON(f).done(c).fail(d).always(b))},b}(),b.get=function(){return null!=d?d:d=new c},b}(),a.fn.bitstampCurrentPrices=function(){return this.loader=c.get(),this.loader.loadPrices(),this.each(function(){var c,d,e,f,g,h;if(c=a(this),h=c.is("input[type=text]"),d="btc",f=c.data("price"),-1===b.indexOf(f))throw"invalid price field";return g=(e=c.data("margin"))?parseFloat(e):1,a(document).on("price-change",function(a,b){var e,i;"volume"===f||"timestamp"===f?(e="volume"===f?parseInt(b[d][f]).toString():(console.debug("timestamp is",b[d][f],typeof b[d][f]),new Date(1e3*parseInt(b[d][f])).toISOString()),h?c.val(e):c.text(e)):(i=parseFloat(b[d][f])*g,h?c.val(parseFloat(i.toFixed(6)).toString()):c.text(parseFloat(i.toFixed(6)).toString()))}),c})}}(jQuery)}.call(this);
//# sourceMappingURL=jquery-bitstampCurrentPrices.0.2.0.min.js.map